<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract spectra associated with features — featureSpectra • xcms</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract spectra associated with features — featureSpectra"><meta property="og:description" content='This function returns spectra associated with the identified features in the
input object. By default, spectra are returned for all features (from all
MS levels), but parameter features allows to specify selected features for
which the result should be returned.
Parameter msLevel allows to define whether MS level 1 or 2
spectra should be returned. For msLevel = 1L all MS1 spectra within the
retention time range of each chromatographic peak (in that respective data
file) associated with a feature are returned. Note that for samples in which
no peak was identified (or even filled-in) no spectra are returned.
For msLevel = 2L all MS2
spectra with a retention time within the retention time range and their
precursor m/z within the m/z range of any chromatographic peak of a feature
are returned. See also chromPeakSpectra() (used internally to extract
spectra for each chromatographic peak of a feature) for additional
information.
In contrast to the chromPeakSpectra() function, selecting a method
different than "all" will not return a single spectrum per feature, but
one spectrum per chromatographic peak assigned to the feature.
Note also that msLevel = 1L is only supported for return.type = "List"
or return.type = "Spectra".'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">xcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.17.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/xcms.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/LC-MS-feature-grouping.html">Compounding (grouping) of LC-MS features</a>
    </li>
    <li>
      <a href="../articles/xcms-direct-injection.html">Grouping FTICR-MS data with xcms</a>
    </li>
    <li>
      <a href="../articles/xcms-lcms-ms.html">LC-MS/MS data analysis with xcms</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sneumann/xcms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract spectra associated with features</h1>
    <small class="dont-index">Source: <a href="https://github.com/sneumann/xcms/blob/HEAD/R/functions-XCMSnExp.R" class="external-link"><code>R/functions-XCMSnExp.R</code></a></small>
    <div class="hidden name"><code>featureSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function returns spectra associated with the identified features in the
input object. By default, spectra are returned for all features (from all
MS levels), but parameter <code>features</code> allows to specify selected features for
which the result should be returned.
Parameter <code>msLevel</code> allows to define whether MS level 1 or 2
spectra should be returned. For <code>msLevel = 1L</code> all MS1 spectra within the
retention time range of each chromatographic peak (in that respective data
file) associated with a feature are returned. Note that for samples in which
no peak was identified (or even filled-in) no spectra are returned.
For <code>msLevel = 2L</code> all MS2
spectra with a retention time within the retention time range and their
precursor m/z within the m/z range of any chromatographic peak of a feature
are returned. See also <code><a href="chromPeakSpectra.html">chromPeakSpectra()</a></code> (used internally to extract
spectra for each chromatographic peak of a feature) for additional
information.</p>
<p>In contrast to the <code><a href="chromPeakSpectra.html">chromPeakSpectra()</a></code> function, selecting a <code>method</code>
different than <code>"all"</code> will not return a single spectrum per feature, but
one spectrum per <strong>chromatographic peak</strong> assigned to the feature.</p>
<p>Note also that <code>msLevel = 1L</code> is only supported for <code>return.type = "List"</code>
or <code>return.type = "Spectra"</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">featureSpectra</span><span class="op">(</span>
  <span class="va">x</span>,
  msLevel <span class="op">=</span> <span class="fl">2L</span>,
  expandRt <span class="op">=</span> <span class="fl">0</span>,
  expandMz <span class="op">=</span> <span class="fl">0</span>,
  ppm <span class="op">=</span> <span class="fl">0</span>,
  skipFilled <span class="op">=</span> <span class="cn">FALSE</span>,
  return.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MSpectra"</span>, <span class="st">"Spectra"</span>, <span class="st">"list"</span>, <span class="st">"List"</span><span class="op">)</span>,
  features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><a href="XCMSnExp-class.html">XCMSnExp</a> object with feature defitions available.</p></dd>
<dt>msLevel</dt>
<dd><p><code>integer(1)</code> defining whether MS1 or MS2 spectra should be
returned. <code>msLevel = 1</code> is currently only supported for <code>return.type</code>
being <code>"Spectra"</code> or <code>"List"</code>.</p></dd>
<dt>expandRt</dt>
<dd><p><code>numeric(1)</code> to expand the retention time range of each
peak by a constant value on each side.</p></dd>
<dt>expandMz</dt>
<dd><p><code>numeric(1)</code> to expand the m/z range of each peak by a
constant value on each side.</p></dd>
<dt>ppm</dt>
<dd><p><code>numeric(1)</code> to expand the m/z range of each peak (on each side)
by a value dependent on the peak's m/z.</p></dd>
<dt>skipFilled</dt>
<dd><p><code>logical(1)</code> whether spectra for filled-in peaks should
be reported or not.</p></dd>
<dt>return.type</dt>
<dd><p><code>character(1)</code> defining the result type. Defaults to
<code>return.type = "MSpectra"</code> but <code>return.type = "Spectra"</code> or
<code>return.type = "List"</code> are preferred. See below for more information.</p></dd>
<dt>features</dt>
<dd><p><code>character</code>, <code>logical</code> or <code>integer</code> allowing to specify a
subset of features in <code>featureDefinitions</code> for which spectra should
be returned (providing either their ID, a logical vector same length
than <code>nrow(featureDefinitions(x))</code> or their index in
<code>featureDefinitions(x)</code>). This parameter overrides <code>skipFilled</code> and is
only supported for <code>return.type</code> being either <code>"Spectra"</code> or <code>"List"</code>.</p></dd>
<dt>...</dt>
<dd><p>additional arguments to be passed along to <code><a href="chromPeakSpectra.html">chromPeakSpectra()</a></code>,
such as <code>method</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>parameter <code>return.type</code> allow to specify the type of the returned object:</p><ul><li><p><code>return.type = "MSpectra"</code>: a <a href="https://lgatto.github.io/MSnbase/reference/MSpectra.html" class="external-link">MSpectra</a> object with elements being
<a href="https://lgatto.github.io/MSnbase/reference/Spectrum-class.html" class="external-link">Spectrum</a> objects. The result objects contains all spectra
for all features. Metadata column <code>"feature_id"</code> provides the ID of the
respective feature (i.e. its rowname in <code><a href="XCMSnExp-class.html">featureDefinitions()</a></code>).</p></li>
<li><p><code>return.type = "Spectra"</code>: a <code>Spectra</code> object (defined in the <code>Spectra</code>
package). The result contains all spectra for all features. Metadata column
<code>"feature_id"</code> provides the ID of the respective feature (i.e. its rowname
in <code><a href="XCMSnExp-class.html">featureDefinitions()</a></code>.</p></li>
<li><p><code>return.type = "list"</code>: <code>list</code> of <code>list</code>s that are either of length
0 or contain <a href="https://lgatto.github.io/MSnbase/reference/Spectrum2-class.html" class="external-link">Spectrum2</a> object(s) within the m/z-rt range. The
length of the list matches the number of features.</p></li>
<li><p><code>return.type = "List"</code>: <code>List</code> of length equal to the number of
features with MS level <code>msLevel</code> is returned with elements being either
<code>NULL</code> (no spectrum found) or a <code>Spectra</code> object.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Johannes Rainer</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

